# 项目介绍

**该产测陪测方案理论上通过更换分离式弹针治具/插座后可适用于大部分灯控器使用，不仅仅局限于ZHAGA系列**

# 开发准备

>### 参考资料
>> - 具体项目介绍请参考[《ZHAGA系列灯控器产测方案书V1.0》](./doc/ZHAGA系列灯控器产测方案书V1.0.docx)
>> - 芯片用户手册请参考[《1-STM32F10x-中文参考手册》](./doc/1-STM32F10x-中文参考手册.pdf)

>### 开发环境
>> - 开发环境搭建：a.安装 Keil MDK  b.安装 STM32CubeMX
>> - 下载、调试工具：JTAG
>> - 下载程序：keil + JTAG,

# 产品功能

>### 系统指示灯
>> * 系统上电后以1Hz固定频率闪烁

>### 被测产品型号选择
>> * 通过拨码开关让陪测模块知道当前被测设备的型号，以便陪测板根据被测型号作出相应测试参数的微调

>### 控制测试暗箱的照度切换
>> * 初始化后，通过按键按第1下则切换到标准照度回路，按第2下则切换到低照度回路，按第3下则切换到高照度回路，按第4下重新切到标准照度回路，以此类推；测试过程中配侧板根据测试进度自动切换暗箱照度

>### 被测板输出信号检测
>> * 检测被测板输出信号的检测（0-10v/PWM/DALI三种调光信号），在包含继电器的灯控器设计中，低照度开灯/高照度关灯测试需要继电器导通信号和调光到0%亮度信号组合判断

>### 测试结果指示LED灯
>> * 根据被测板的输出信号调整LED灯的状态，低/高照度指示灯测试过程中以1Hz频率闪烁，测试通过则相应的LED指示灯绿色常亮，测试不通过则相应的LED指示灯红色常亮；最终测试结果LED指示灯，初始状态为灭灯状态，若高低照度都测试通过则绿色指示灯常亮，只要有一项测试失败即终止测试则红色指示灯常亮
# 功能实现

>> - 使用STM32CubeMX搭建代码工程
>> - 配置IO口输出模式高低电平控制LED系统指示灯以1Hz的固定频率闪烁
>> - 配置IO口输入模式通过检测输入引脚的高低电平切换不同型号被测板参数
>> - 配置IO口输入模式通过检测输入引脚的高低电平切换不同照度回路
>> - 配置ADC(0-10V输出电压转换后作为ADC的输入)根据ADC值，输出不同的测试结果；配置USART根据串口数据的低电平的个数检测DALI的输出，输出不同的测试结果
>> - 配置IO口输出模式高低电平控制测试结果LED指示灯

**注：功能实现基于freertos创建3个任务（任务1：手动照度切换、被测板型号检测、开始测试；任务2：检测被测板输出信号，根据测试时间或测试结果发送切换照度信号；任务3：根据切换照度信号控制相应的管脚切换相应照度。）**
